<x-app-layout>
    <x-slot name="breadcrumb">
        <x-link-breadcrumb text="OFERTAS" active>
            <x-slot name="icon">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 7l.867 12.143a2 2 0 0 0 2 1.857h10.276a2 2 0 0 0 2 -1.857l.867 -12.143h-16z" />
                    <path d="M8.5 7c0 -1.653 1.5 -4 3.5 -4s3.5 2.347 3.5 4" />
                    <path
                        d="M9.5 17c.413 .462 1 1 2.5 1s2.5 -.897 2.5 -2s-1 -1.5 -2.5 -2s-2 -1.47 -2 -2c0 -1.104 1 -2 2 -2s1.5 0 2.5 1" />
                </svg>
            </x-slot>
        </x-link-breadcrumb>
    </x-slot>

    <div class="w-full p-1 md:px-3">
        @if (count($ofertas) > 0)
            {{-- <h1 class="font-medium uppercase text-xs py-3 text-colorsubtitleform">
                Descubre nuestras ofertas que tenemos para tí</h1> --}}
            <div class="w-full flex justify-end py-2">
                {{ $ofertas->onEachSide(0)->links('pagination::pagination-default') }}
            </div>

            <div
                class="grid grid-cols-[repeat(auto-fill,minmax(180px,1fr))] sm:grid-cols-[repeat(auto-fill,minmax(220px,1fr))] gap-1 self-start">
                @foreach ($ofertas as $item)
                    @php
                        $image = !empty($item->image) ? pathURLProductImage($item->image) : null;
                        $secondimage = !empty($item->image_2) ? pathURLProductImage($item->image_2) : null;
                        $tipocambio = $empresa->usarDolar() ? $empresa->tipocambio : null;
                        $pricesale = $item->getPrecioVenta($pricetype);
                        $priceold = $item->getPrecioVentaDefault($pricetype);
                        $promocion = null;
                        $paddingTop = '';

                        if ($item->descuento > 0 || $item->liquidacion) {
                            $promocion = $item->promocions
                                ->where('type', '<>', \App\Enums\PromocionesEnum::COMBO->value)
                                ->first();
                        }
                        if ($item->stock > 0 && $empresa->viewAlmacens() == false) {
                            $paddingTop = 'xl:pb-20';
                            if (!empty($promocion)) {
                                $paddingTop = 'xl:pb-12';
                            }
                        }

                    @endphp

                    <x-card-producto-virtual :route="route('productos.show', $item)" :name="$item->name" :marca="$item->name_marca" :sku="$item->sku"
                        :novedad="$item->isNovedad()" :image="$image" :secondimage="$secondimage" :promocion="$promocion"
                        wire:key="cardproduct{{ $item->id }}" x-data="{ addcart: isXL ? false : true }" @mouseover="addcart = true"
                        @mouseleave="isXL && (addcart = false)"
                        class="w-full pt-0 rounded-md md:rounded-xl ring-1 ring-borderminicard hover:shadow-md hover:shadow-shadowminicard overflow-hidden transition ease-in-out duration-150"
                        x-init="$watch('isXL', value => { addcart = value ? false : true; })">

                        @if ($pricesale > 0)
                            <div class="{{ $paddingTop }} text-center flex flex-col justify-center">
                                @if ($empresa->verDolar())
                                    <h1 class="text-blue-700 font-medium text-[1rem] text-center">
                                        <small class="text-xs">$. </small>
                                        {{ convertMoneda($pricesale, 'USD', $empresa->tipocambio, 2, ', ') }}
                                    </h1>
                                @endif
                                <h1 class="text-colorlabel font-semibold text-sm sm:text-2xl text-center">
                                    <small class="text-sm">{{ $moneda->simbolo }}</small>
                                    {{ decimalOrInteger($pricesale, 2, ', ') }}
                                </h1>
                                @if (!empty($promocion) && $empresa->verOldprice())
                                    <h1 class="text-colorsubtitleform text-center text-[10px] text-red-600">
                                        {{ $moneda->simbolo }}
                                        <small class="text-sm inline-block line-through">
                                            {{ decimalOrInteger($item->getPrecioVentaDefault($pricetype), 2, ', ') }}</small>
                                    </h1>
                                @endif

                                @if ($item->stock > 0)
                                    <x-slot name="buttonscart">
                                        <div class="w-full p-1">
                                            @if ($item->promocions->where('type', \App\Enums\PromocionesEnum::COMBO->value)->count() > 0)
                                                <x-link-button href="{{ route('productos.show', $item) }}"
                                                    wire:loading.attr="disabled"
                                                    class="!rounded-xl w-full !flex gap-2 items-center justify-center text-[10px]">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"
                                                        fill="currentColor" stroke="currentColor" stroke-width=".5"
                                                        class="block w-4 h-4 text-inherit">
                                                        <path
                                                            d="m19.534 11.063.88-1.253L24 4.709c.21-.297.418-.599.64-.887a1 1 0 0 1 .576-.411 1.28 1.28 0 0 1 1.065.224l2.336 1.717 3.694 2.715 4.071 2.994q1.371 1.006 2.738 2.016a.9.9 0 0 0 .562.178c.464-.002.93-.025 1.39.025 1.611.183 2.798 1.481 2.896 2.891q.082 1.207.174 2.414c.114 1.513.238 3.022.343 4.533.082 1.131.142 2.261.219 3.39.069 1.01.151 2.021.226 3.031l.217 2.944q.091 1.211.171 2.43.119 1.81.215 3.625c.041.791.053 1.582.089 2.373.021.443.069.882.091 1.326q.009.336-.034.672a7 7 0 0 1-.142.768 2.22 2.22 0 0 1-.974 1.342c-.64.434-1.351.686-2.135.688q-2.011.005-4.025 0l-10.745.005H15.223c-3.129 0-6.256-.009-9.385.005a3.7 3.7 0 0 1-2.528-.901c-.759-.654-1.074-1.495-1.017-2.482q.062-1.031.133-2.062c.053-.754.114-1.511.167-2.267q.039-.613.069-1.223l.133-2.24q.064-1.243.137-2.489.069-1.193.153-2.386l.169-2.443q.105-1.495.199-2.99c.057-.928.103-1.856.16-2.784q.126-2.011.258-4.023c.03-.45.03-.907.096-1.353.185-1.255.894-2.11 2.066-2.59q.64-.256 1.328-.235c.439.009.88-.002 1.319.005.133 0 .174-.037.174-.174q-.009-2.56-.009-5.125c0-1.509.016-3.022-.002-4.533-.009-.663.443-1.12 1.109-1.129q1.063-.01 2.13-.007l6.245.007c.279 0 .539.053.766.224a.91.91 0 0 1 .389.667q.023.183.025.366v7.504zm4.537 32.482h18.087c.233 0 .469 0 .693-.041.491-.094.882-.633.843-1.131l-.032-.265q-.151-2.002-.293-4.002c-.075-1.125-.139-2.249-.21-3.374q-.089-1.474-.185-2.949c-.069-.976-.155-1.95-.222-2.926-.096-1.429-.181-2.857-.274-4.286l-.261-3.961-.304-4.418c-.034-.48-.423-.93-.907-.965-.539-.037-1.083-.016-1.623-.011-.263 0-.523.032-.784.03-.24-.002-.48-.046-.72-.046q-9.029-.007-18.057 0c-.315 0-.629.046-.944.064-.215.011-.43.023-.645.011-.295-.016-.587-.075-.882-.075q-3.271-.007-6.54-.005a2 2 0 0 0-.279.018 4.6 4.6 0 0 1-1.131.023 18 18 0 0 0-2.039-.027 1.2 1.2 0 0 0-1.143 1.127q-.082 1.287-.176 2.576l-.265 3.845-.265 4.034-.208 3.093q-.133 1.874-.261 3.755c-.085 1.287-.16 2.571-.245 3.858l-.315 4.699a1.37 1.37 0 0 0 .094.722c.229.455.608.626 1.099.624l7.623.002h10.775ZM10.997 13.236q.069.009.13.011h6.069c.107 0 .13-.034.13-.137l.005-2.805q0-2.841.009-5.685c0-.139-.037-.183-.183-.183q-3.003.007-6.009.005l-.151.007zm9.653 0h15.054l-9.897-7.278z" />
                                                        <path
                                                            d="m19.534 11.063.88-1.253L24 4.709c.21-.297.418-.599.64-.887a1 1 0 0 1 .576-.411 1.28 1.28 0 0 1 1.065.224l2.336 1.717 3.694 2.715 4.071 2.994q1.371 1.006 2.738 2.016a.9.9 0 0 0 .562.178c.464-.002.93-.025 1.39.025 1.611.183 2.798 1.481 2.896 2.891q.082 1.207.174 2.414c.114 1.513.238 3.022.343 4.533.082 1.131.142 2.261.219 3.39.069 1.01.151 2.021.226 3.031l.217 2.944q.091 1.211.171 2.43.119 1.81.215 3.625c.041.791.053 1.582.089 2.373.021.443.069.882.091 1.326q.009.336-.034.672a7 7 0 0 1-.142.768 2.22 2.22 0 0 1-.974 1.342c-.64.434-1.351.686-2.135.688q-2.011.005-4.025 0l-10.745.005H15.223c-3.129 0-6.256-.009-9.385.005a3.7 3.7 0 0 1-2.528-.901c-.759-.654-1.074-1.495-1.017-2.482q.062-1.031.133-2.062c.053-.754.114-1.511.167-2.267q.039-.613.069-1.223l.133-2.24q.064-1.243.137-2.489.069-1.193.153-2.386l.169-2.443q.105-1.495.199-2.99c.057-.928.103-1.856.16-2.784q.126-2.011.258-4.023c.03-.45.03-.907.096-1.353.185-1.255.894-2.11 2.066-2.59q.64-.256 1.328-.235c.439.009.88-.002 1.319.005.133 0 .174-.037.174-.174q-.009-2.56-.009-5.125c0-1.509.016-3.022-.002-4.533-.009-.663.443-1.12 1.109-1.129q1.063-.01 2.13-.007l6.245.007c.279 0 .539.053.766.224a.91.91 0 0 1 .389.667q.023.183.025.366v7.504zm4.537 32.482h18.087c.233 0 .469 0 .693-.041.491-.094.882-.633.843-1.131l-.032-.265q-.151-2.002-.293-4.002c-.075-1.125-.139-2.249-.21-3.374q-.089-1.474-.185-2.949c-.069-.976-.155-1.95-.222-2.926-.096-1.429-.181-2.857-.274-4.286l-.261-3.961-.304-4.418c-.034-.48-.423-.93-.907-.965-.539-.037-1.083-.016-1.623-.011-.263 0-.523.032-.784.03-.24-.002-.48-.046-.72-.046q-9.029-.007-18.057 0c-.315 0-.629.046-.944.064-.215.011-.43.023-.645.011-.295-.016-.587-.075-.882-.075q-3.271-.007-6.54-.005a2 2 0 0 0-.279.018 4.6 4.6 0 0 1-1.131.023 18 18 0 0 0-2.039-.027 1.2 1.2 0 0 0-1.143 1.127q-.082 1.287-.176 2.576l-.265 3.845-.265 4.034-.208 3.093q-.133 1.874-.261 3.755c-.085 1.287-.16 2.571-.245 3.858l-.315 4.699a1.37 1.37 0 0 0 .094.722c.229.455.608.626 1.099.624l7.623.002h10.775ZM10.997 13.236q.069.009.13.011h6.069c.107 0 .13-.034.13-.137l.005-2.805q0-2.841.009-5.685c0-.139-.037-.183-.183-.183q-3.003.007-6.009.005l-.151.007zm9.653 0h15.054l-9.897-7.278z" />
                                                        <path
                                                            d="M32.923 22.329c.19-.274.432-.48.773-.521l-19.177-.261a1.44 1.44 0 0 0-.841.046 1.2 1.2 0 0 0-.608.558 1.44 1.44 0 0 0 .023 1.506c.672 1.111 1.586 1.982 2.619 2.706 1.559 1.09 3.31 1.696 5.134 2.041a16 16 0 0 0 2.846.265v.078l.37-.032q.386-.03.777-.055a29 29 0 0 0 1.831-.169 13.7 13.7 0 0 0 3.671-.992c1.552-.67 2.914-1.6 4.007-2.923q.496-.603.791-1.326a1.05 1.05 0 0 0-.037-.937 1.65 1.65 0 0 0-.869-.777 1.4 1.4 0 0 0-.576-.069 1.42 1.42 0 0 0-1.015.667m.281.194-.281-.194m.281.194-.144.215a7 7 0 0 1-.389.544zm-.281-.194-.16.235a5 5 0 0 1-.354.496m.514-.731-.514.731m0 0c-.754.896-1.705 1.531-2.789 1.995zm-10.665 2.762a16.7 16.7 0 0 0 3.801.16 12.1 12.1 0 0 0 4.071-.926zm0 0c-1.378-.231-2.681-.645-3.854-1.378zm-3.854-1.378a7.3 7.3 0 0 1-2.233-2.128zm-2.233-2.13a1.33 1.33 0 0 0-.859-.571z" />
                                                    </svg>
                                                    VER COMBOS
                                                </x-link-button>
                                            @else
                                                <x-link-button href="{{ route('productos.show', $item) }}"
                                                    wire:loading.attr="disabled"
                                                    class="!rounded-xl w-full !flex gap-0.5 items-center justify-center text-[10px]">
                                                    VER PROMOCIÓN</x-link-button>
                                            @endif
                                        </div>
                                    </x-slot>
                                @else
                                    <span
                                        class="inline-block p-1 mx-auto mb-1 rounded-lg bg-red-600 text-white text-[10px] float-right">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="currentColor"
                                            stroke="currentColor" stroke-width="0.7" stroke-linecap="round"
                                            stroke-linejoin="round" class="inline-block w-4 h-4">
                                            <path
                                                d="m13.58,16.14c-2.68-5.62-.35-11.07,3.31-13.8,3.93-2.94,9.38-3.15,13.53-.47,1.56,1.01,2.8,2.31,3.71,3.9.92,1.6,1.4,3.33,1.44,5.16.05,1.81-.37,3.53-1.19,5.2,1.38.67,2.69,1.38,4.05,1.95,1.82.76,3.34,1.86,4.69,3.26,1.41,1.48,2.94,2.87,4.41,4.29.7.68.61,1.19-.28,1.63-1.81.88-3.62,1.77-5.45,2.63-.32.15-.44.32-.44.68.02,2.79,0,5.57.02,8.36,0,.56-.2.89-.72,1.14-5.35,2.58-10.69,5.16-16.02,7.76-.46.23-.86.2-1.31-.02-5.34-2.6-10.68-5.18-16.02-7.76-.48-.23-.69-.54-.68-1.06.01-2.79,0-5.57.02-8.36,0-.38-.1-.59-.47-.76-1.83-.86-3.64-1.75-5.45-2.63-.85-.41-.94-.93-.26-1.6,2.06-2,4.12-3.99,6.18-5.98.2-.2.45-.36.71-.49,1.9-.93,3.81-1.85,5.72-2.78.17-.08.33-.17.52-.27Zm-5.26,14.82c-.02.09-.04.13-.04.18,0,2.43,0,4.87.01,7.3,0,.16.18.38.34.46,5.01,2.44,10.02,4.87,15.04,7.28.18.08.47.08.65,0,5.01-2.41,10.01-4.83,15.01-7.24.29-.14.38-.31.38-.62-.01-2.32,0-4.64,0-6.95,0-.12-.02-.25-.03-.41-.21.1-.36.16-.52.24-2.65,1.28-5.29,2.56-7.94,3.84-.66.32-.89.28-1.41-.23-1.8-1.75-3.6-3.49-5.41-5.24-.13-.13-.27-.24-.47-.43-.14.17-.25.32-.38.45-1.79,1.74-3.58,3.47-5.37,5.2-.55.53-.77.56-1.46.23-2.63-1.27-5.26-2.55-7.89-3.82-.16-.08-.33-.15-.52-.23ZM24.01,1.6c-5.41-.03-9.9,4.26-9.94,9.49-.04,5.33,4.37,9.7,9.81,9.72,5.56.03,10.02-4.24,10.04-9.59.02-5.29-4.42-9.6-9.91-9.62Zm-1.5,26.63c-.06-.04-.14-.09-.23-.14-4.78-2.32-9.57-4.63-14.34-6.95-.29-.14-.42-.05-.61.13-1.61,1.57-3.24,3.14-4.85,4.71-.07.06-.12.14-.21.24,5.01,2.42,9.97,4.82,14.88,7.2,1.81-1.75,3.58-3.47,5.37-5.19Zm8.35,5.19c4.91-2.38,9.88-4.78,14.9-7.21-1.71-1.66-3.38-3.25-5.02-4.87-.27-.27-.47-.31-.82-.14-3.87,1.89-7.74,3.76-11.62,5.63-.95.46-1.9.92-2.83,1.38,1.8,1.74,3.57,3.45,5.39,5.21Zm7.82-13.4c-1.78-.86-3.45-1.67-5.11-2.47-4.8,6.58-14.71,6.38-19.17,0-1.66.8-3.33,1.61-5.07,2.45.17.1.25.15.34.19,4.68,2.26,9.35,4.53,14.03,6.78.17.08.47.05.65-.03,3.01-1.44,6.01-2.89,9.01-4.34,1.74-.84,3.47-1.68,5.32-2.58Z" />
                                            <path
                                                d="m24.04,12.31c-1.42,1.37-2.75,2.65-4.07,3.94-.11.11-.21.22-.33.32-.4.33-.88.32-1.2-.01-.31-.32-.31-.77.03-1.13.51-.52,1.05-1.02,1.57-1.52.91-.89,1.82-1.77,2.77-2.7-.13-.13-.25-.27-.38-.39-1.29-1.25-2.59-2.5-3.87-3.75-.43-.42-.46-.89-.1-1.23.36-.34.84-.32,1.27.1,1.28,1.23,2.56,2.48,3.83,3.72.13.13.24.28.38.45.22-.2.37-.33.51-.47,1.25-1.21,2.51-2.43,3.76-3.65.47-.45.94-.51,1.31-.17.39.35.34.84-.14,1.31-1.39,1.35-2.77,2.69-4.2,4.07.14.14.26.27.39.4,1.22,1.18,2.44,2.36,3.66,3.54.09.08.17.16.25.25.38.41.41.87.06,1.2-.35.33-.83.32-1.24-.07-1.15-1.1-2.29-2.21-3.43-3.33-.28-.27-.54-.56-.84-.87Z" />
                                        </svg>AGOTADO
                                    </span>
                                @endif
                            </div>
                        @else
                            <p class="text-colorerror text-[10px] font-semibold text-center">
                                PRECIO DE VENTA NO ENCONTRADO</p>
                        @endif

                        <x-slot name="footer">
                            @if ($empresa->viewAlmacens())
                                @if (count($item->almacens) > 0)
                                    <div class="w-full p-1 pt-0 flex flex-wrap items-end  gap-1">
                                        @foreach ($item->almacens as $alm)
                                            <span
                                                class="inline-block p-2 sm:p-2.5 rounded-lg text-[9px] sm:text-[10px] text-primary border border-next-300">
                                                {{ $alm->name }}
                                                <svg xmlns="http://www.w3.org/2000/svg" class="size-5 inline-block"
                                                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                                                    <path
                                                        d="M13 22C12.1818 22 11.4002 21.6588 9.83691 20.9764C8.01233 20.18 6.61554 19.5703 5.64648 19H2M13 22C13.8182 22 14.5998 21.6588 16.1631 20.9764C20.0544 19.2779 22 18.4286 22 17V6.5M13 22L13 11M4 6.5L4 9.5" />
                                                    <path
                                                        d="M9.32592 9.69138L6.40472 8.27785C4.80157 7.5021 4 7.11423 4 6.5C4 5.88577 4.80157 5.4979 6.40472 4.72215L9.32592 3.30862C11.1288 2.43621 12.0303 2 13 2C13.9697 2 14.8712 2.4362 16.6741 3.30862L19.5953 4.72215C21.1984 5.4979 22 5.88577 22 6.5C22 7.11423 21.1984 7.5021 19.5953 8.27785L16.6741 9.69138C14.8712 10.5638 13.9697 11 13 11C12.0303 11 11.1288 10.5638 9.32592 9.69138Z" />
                                                    <path d="M18.1366 4.01563L7.86719 8.98485" />
                                                    <path d="M2 13H5" />
                                                    <path d="M2 16H5" />
                                                </svg>
                                            </span>
                                        @endforeach
                                    </div>
                                @endif
                            @endif
                        </x-slot>
                    </x-card-producto-virtual>
                @endforeach
            </div>
        @else
            <p class="text-xs text-center text-colorsubtitleform">
                ACTUALMENTE NO TENEMOS OFERTAS DISPONIBLES...</p>

            <div class="p-5 flex justify-center items-center">
                <x-link-web text="VER TODOS LOS PRODUCTOS" class="mx-auto" href="{{ route('productos') }}" />
            </div>
        @endif
    </div>

    <script></script>
</x-app-layout>
